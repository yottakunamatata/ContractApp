Record As screen:
    OnVisible: |+
        =Concurrent(
        UpdateContext({SC_valid_startDate_msg:""}),
        UpdateContext({SC_valid_endDate_msg:""}),
        UpdateContext({var_duration:400}),
        UpdateContext({var_Click:0}),
        UpdateContext({var_NewItem:""}),
        UpdateContext({const_mainContract: "主約"}),
        UpdateContext({const_subContract: "附約"}),
        UpdateContext({const_suppleB: "追加金額"}),
        UpdateContext({const_Currency_NTD: "NTD"}),
        UpdateContext({const_Currency_USD: "USD"}),
        UpdateContext({const_API_Path:"appres://datasources/ContractFiles/table/ac721157-e8e0-414c-902e-5effc3da96cd/rows/6/reference/https:%2F%2Fasia-001.azure-apim.net%2Fapim%2Fsharepointonline%2Ff5f59dba7d124245b15af36dc5e6479c%2Fdatasets%2Fhttps%25253a%25252f%25252fchangchuncorporation.sharepoint.com%25252fsites%25252fBPM_DEV2%25252fdev_bpmsub%25252frdlab%2FGetFileContentByPath%3Fpath=%252f"}),
        UpdateContext({msg_valid_afterToday: "Selected date cannot be after Today"}),
        UpdateContext({msg_valid_afterEndDate: "Selected date cannot be after End Date"}),
        UpdateContext({msg_valid_beforeStartDate: "Selected date cannot be befor Start Date"}),
        UpdateContext({msg_updateSuccess: "Upadte Success"}),
        UpdateContext({msg_deleteSuccess: "Delete Success"}),
        UpdateContext({Main_AM: 0}),
        UpdateContext({var_SCS_DV_projectName:""}),
        UpdateContext({var_SCS_DV_contractDefine:""}),
        UpdateContext({var_SCS_DV_CMID:""}),
        UpdateContext({msg_loading: "Exporting applications..."}),
        UpdateContext({msg_exportError: "Exporting failed, please contact related department."}),
        UpdateContext({SB_DT_EditBool:false}),
        UpdateContext({Bool_DV_Visible:false})
        );
        
        
        ClearCollect(
            ReportCollect,
            ContractManagementList
        );
        
        ClearCollect(
            addCol_C_R,
            AddColumns(
                ReportCollect As Filter_DS,
                "Vendor_text",
                Filter_DS.Vendor.Value,
                "Title_contratType",
                Filter_DS.'是主約、附約或追加金額？'.Value,
                "contract_Group",
                Filter_DS.簽約主體,
                "Currency_text",
                Filter_DS.Currency.Value,
                "Part_A_Signer",
                Filter_DS.我方簽約,
                "Part_B_Signer",
                Filter_DS.對方簽約人,
                "sign-in Date",
                Filter_DS.'Sign-inDate',
                "Reason_T",
                Filter_DS.追加原因,
                "Contract_type",
                Filter_DS.ContractType.Value,
                "Belong_Main",
                If(
                    Filter_DS.'是主約、附約或追加金額？'.Value = const_mainContract,
                    Text(Filter_DS.ID),
                    Filter_DS.'是主約、附約或追加金額？'.Value = const_subContract || (Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.附約)),
                    Text(Filter_DS.主約),
                    Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.主約),
                    ""
                ),
                "sub_rank",
                If(
                    Filter_DS.'是主約、附約或追加金額？'.Value = const_mainContract || (Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.附約)),
                    -1,
                    Filter_DS.'是主約、附約或追加金額？'.Value = const_subContract,
                    Text(Filter_DS.ID),
                    Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.主約),
                    Filter_DS.附約
                ),
                "rank",
                If(
                    Filter_DS.'是主約、附約或追加金額？'.Value = const_mainContract,
                    1,
                    Filter_DS.'是主約、附約或追加金額？'.Value = const_subContract,
                    3,
                    Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.附約),
                    2,
                    4
                ),
                "Group",
                If(
                    Filter_DS.'是主約、附約或追加金額？'.Value = const_mainContract,
                    Filter_DS.ProjectName,
                    ""
                ),
                "SubGroup",
                If(
                    Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.主約),
                        First( 
                            Filter(ReportCollect As fiter_DS,
                                    fiter_DS.ID = Value(Filter_DS.附約)
                                )
                        ).ProjectName,
                    Filter_DS.'是主約、附約或追加金額？'.Value = const_subContract,
                        Filter_DS.ProjectName,
                        Blank()
                )
            )
        );
        ClearCollect(
            updateCol_C_R,
            UpdateIf(
                addCol_C_R As updateIf_DS,
                updateIf_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(updateIf_DS.主約),
                {
                    Belong_Main: First(
                        Filter(
                            addCol_C_R As fiter_DS,
                            fiter_DS.ID = Value(updateIf_DS.附約)
                        )
                    ).Belong_Main
                }
            )
        );
        
        ClearCollect(
            fin_C_R,
            UpdateIf(
                updateCol_C_R As updateIf_DS,
                updateIf_DS.'是主約、附約或追加金額？'.Value <> const_mainContract,
                {
                    Group: First(
                                Filter(
                                    updateCol_C_R As fiter_DS,
                                    fiter_DS.ID = Value(updateIf_DS.Belong_Main)
                                )
                        ).ProjectName
                }
            )
        );
        

    Rectangle8 As rectangle:
        Fill: =RGBA(237, 237, 237, 0.59)
        Height: =665
        Width: =1121
        X: =245
        Y: =86
        ZIndex: =1

    Navigation_3 As Navigation_1:
        Y: =76
        ZIndex: =2

    Rectangle6 As rectangle:
        Fill: =RGBA(219, 219, 219, 1)
        Height: =111
        Width: =1104
        X: =245
        Y: =639
        ZIndex: =3

    Header_4 As Header:
        ZIndex: =4

    Rectangle7_3 As rectangle:
        Fill: =RGBA(255, 191, 0, 0.28)
        Height: =85
        Width: =227
        Y: =362
        ZIndex: =5

    Contract As dataTable.datatable:
        BorderStyle: =BorderStyle.Solid
        DisplayMode: =DisplayMode.Edit
        Fill: =RGBA(0, 0, 0, 0)
        Height: =475
        Items: |-
            =SortByColumns(
                Filter(
                    fin_C_R As DS,
                    If(
                        CountRows(ComboBox1.SelectedItems) > 0,
                        DS.Vendor.Value in ComboBox1.SelectedItems.Result,
                        1 = 1
                    ),
                    If(
                        CountRows(ComboBox1_1.SelectedItems) > 0,
                        DS.contract_Group in ComboBox1_1.SelectedItems.Result,
                        1 = 1
                    ),
                                    Text(DS.deletionFlag) = Text(false)
                ),
                "contract_Group",
                Ascending,
                "Vendor_text",
                Ascending,
                "Belong_Main",
                Ascending,
                "sub_rank",
                Ascending,
                "rank",
                Ascending,
                "DocumentDate",
                Descending
            )
        Width: =1103
        X: =245
        Y: =174
        ZIndex: =6

        Title_資料行1 As dataTableColumn.textualColumn:
            AutoWidth: =false
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Project Number"
            FieldName: ="Title"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =13
            Text: =ThisItem.Title
            Width: =134
            X: =0
            Y: =0
            ZIndex: =1

        Vendor_資料行1 As dataTableColumn.textualColumn:
            AutoWidth: =false
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Vendor"
            FieldName: ="Vendor"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =11
            Text: =ThisItem.Vendor.Value
            Width: =80
            X: =0
            Y: =0
            ZIndex: =3

        DocumentDate_資料行1 As dataTableColumn.textualColumn:
            AutoWidth: =false
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Document Date"
            FieldName: ="DocumentDate"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =12
            Text: =ThisItem.DocumentDate
            Width: =114
            X: =943
            Y: =0
            ZIndex: =7

        Currency_資料行1 As dataTableColumn.textualColumn:
            AutoWidth: =false
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Currency"
            FieldName: ="Currency"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =21
            Text: =ThisItem.Currency.Value
            Width: =88
            X: =0
            Y: =0
            ZIndex: =9

        Amount_資料行1 As dataTableColumn.numberColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Budget"
            FieldName: ="Amount"
            FieldVariantName: ="numberColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =22
            Text: |-
                =Text(Value(ThisItem.Amount, "en-US"), "#,###", "en-US")
            Width: =100
            X: =0
            Y: =0
            ZIndex: =10

        ProjectName_資料行1 As dataTableColumn.textualColumn:
            AutoWidth: =false
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Project Name"
            FieldName: ="ProjectName"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =14
            Text: =ThisItem.ProjectName
            Width: =219
            X: =0
            Y: =0
            ZIndex: =12

        Remark_資料行1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Remark"
            FieldName: ="Remark"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =30
            Text: =ThisItem.Remark
            Width: =100
            X: =0
            Y: =0
            ZIndex: =14

        contract_Group_Column1 As dataTableColumn.textualColumn:
            AutoWidth: =false
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Company"
            FieldName: ="contract_Group"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =10
            Text: =ThisItem.contract_Group
            Width: =125
            X: =393
            Y: =0
            ZIndex: =20

        Group_Column1 As dataTableColumn.textualColumn:
            AutoWidth: =false
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Group"
            FieldName: ="Group"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =1
            Text: =ThisItem.Group
            Width: =203
            X: =0
            Y: =0
            ZIndex: =23

        Part_A_Signer_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Part A Signer"
            FieldName: ="Part_A_Signer"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =26
            Text: =ThisItem.Part_A_Signer
            Width: =100
            X: =0
            Y: =0
            ZIndex: =25

        Part_B_Signer_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Part B Signer"
            FieldName: ="Part_B_Signer"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =27
            Text: =ThisItem.Part_B_Signer
            Width: =100
            X: =0
            Y: =0
            ZIndex: =26

        Created_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Created"
            FieldName: ="Created"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =32
            Text: =ThisItem.Created
            Width: =100
            X: =0
            Y: =0
            ZIndex: =27

        Modified_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Modified"
            FieldName: ="Modified"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =33
            Text: =ThisItem.Modified
            Width: =100
            X: =0
            Y: =0
            ZIndex: =28

        "'sign-in Date_Column1' As dataTableColumn.textualColumn":
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="sign-in Date"
            FieldName: ="sign-in Date"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =29
            Text: =ThisItem.'sign-in Date'
            Width: =100
            X: =0
            Y: =0
            ZIndex: =29

        Reason_T_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="Reason"
            FieldName: ="Reason_T"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =31
            Text: =ThisItem.Reason_T
            Width: =100
            X: =0
            Y: =0
            ZIndex: =30

        SubGroup_Column1 As dataTableColumn.textualColumn:
            DisplayMode: =DisplayMode.Edit
            FieldDisplayName: ="SubGroup"
            FieldName: ="SubGroup"
            FieldVariantName: ="textualColumn"
            Height: =Parent.Height
            LayoutHeight: =Parent.Height
            Order: =8
            Text: =ThisItem.SubGroup
            Width: =100
            X: =0
            Y: =0
            ZIndex: =31

    Label3 As label:
        FontWeight: =FontWeight.Bold
        Size: =30
        Text: |-
            ="Total : "
        X: =455
        Y: =678
        ZIndex: =7

    Label4_4 As label:
        FontWeight: =FontWeight.Bold
        Height: =52
        Size: =23
        Text: ="Vendor"
        Underline: =true
        Width: =143
        X: =864
        Y: =111
        ZIndex: =9

    Button5 As button:
        DisplayMode: |-
            =If(
                CountRows(
                    Filter(
                        ReportCollect As DS,
                        If(
                            CountRows(ComboBox1.SelectedItems) > 0,
                            DS.Vendor.Value in ComboBox1.SelectedItems.Result,
                            1 = 1
                        ),
                        If(
                            CountRows(ComboBox1_1.SelectedItems) > 0,
                            DS.簽約主體 in ComboBox1_1.SelectedItems.Result,
                            1 = 1
                        )
                    )
                ) > 0,
                DisplayMode.Edit,
                DisplayMode.Disabled
            )
        Fill: =RGBA(127, 178, 57, 1)
        OnSelect: |
            =Refresh(ContractManagementList);
            ClearCollect(
                ExportCollect_E,
                ContractManagementList
            );
            ClearCollect(
                Filte_C_E,
                Filter(
                    ExportCollect_E As DS,
                    If(
                        CountRows(ComboBox1.SelectedItems) > 0,
                        DS.Vendor.Value in ComboBox1.SelectedItems.Result,
                        1 = 1
                    ),
                    If(
                        CountRows(ComboBox1_1.SelectedItems) > 0,
                        DS.簽約主體 in ComboBox1_1.SelectedItems.Result,
                        1 = 1
                    ),
                    Text(DS.deletionFlag) = Text(false)
                )
            );
            ClearCollect(
                addCol_C_E,
                AddColumns(
                    Filte_C_E As Filter_DS,
                    "Vendor_text",
                    Filter_DS.Vendor.Value,
                    "Title_contratType",
                    Filter_DS.'是主約、附約或追加金額？'.Value,
                    "contract_Group",
                    Filter_DS.簽約主體,
                    "Currency_text",
                    Filter_DS.Currency.Value,
                    "Part_A_Signer",
                    Filter_DS.我方簽約,
                    "Part_B_Signer",
                    Filter_DS.對方簽約人,
                    "sign-in Date",
                    Filter_DS.'Sign-inDate',
                    "Reason_T",
                    Filter_DS.追加原因,
                    "Contract_type",
                    Filter_DS.ContractType.Value,
                    "Belong_Main",
                    If(
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_mainContract,
                        Text(Filter_DS.ID),
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_subContract || (Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.附約)),
                        Text(Filter_DS.主約),
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.主約),
                        ""
                    ),
                    "sub_rank",
                    If(
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_mainContract || (Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.附約)),
                        -1,
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_subContract,
                        Text(Filter_DS.ID),
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.主約),
                        Filter_DS.附約
                    ),
                    "rank",
                    If(
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_mainContract,
                        1,
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_subContract,
                        3,
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.附約),
                        2,
                        4
                    ),
                    "Group",
                    If(
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_mainContract,
                        Filter_DS.ProjectName,
                        ""
                    ),
                    "SubGroup",
                    If(
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.主約),
                        First(
                            Filter(
                                Filte_C_E As fiter_DS,
                                fiter_DS.ID = Value(Filter_DS.附約)
                            )
                        ).ProjectName,
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_subContract,
                        Filter_DS.ProjectName,
                        Blank()
                    )
                )
            );
            ClearCollect(
                updateCol_C_E,
                UpdateIf(
                    addCol_C_E As updateIf_DS,
                    updateIf_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(updateIf_DS.主約),
                    {
                        Belong_Main: First(
                            Filter(
                                addCol_C_E As fiter_DS,
                                fiter_DS.ID = Value(updateIf_DS.附約)
                            )
                        ).Belong_Main
                    }
                )
            );
            ClearCollect(
                fin_C_E,
                UpdateIf(
                    updateCol_C_E As updateIf_DS,
                    updateIf_DS.'是主約、附約或追加金額？'.Value <> const_mainContract,
                    {
                        Group: First(
                            Filter(
                                updateCol_C_E As fiter_DS,
                                fiter_DS.ID = Value(updateIf_DS.Belong_Main)
                            )
                        ).ProjectName
                    }
                )
            );
            Set(
                OutPutTxt,
                JSON(
                    SortByColumns(
                        ShowColumns(
                            fin_C_E,
                            "contract_Group",
                            "Vendor_text",
                            "DocumentDate",
                            "Title",
                            "ProjectName",
                            "Currency_text",
                            "Amount",
                            "Part_A_Signer",
                            "Part_B_Signer",
                            "sign-in Date",
                            "Contract_type",
                            "Remark",
                            "Reason_T",
                            "Belong_Main",
                            "Title_contratType",
                            "sub_rank",
                            "rank",
                            "Group",
                            "SubGroup",
                            "Created",
                            "Modified"
                        ),
                        "contract_Group",
                        Ascending,
                        "Vendor_text",
                        Ascending,
                        "Belong_Main",
                        Ascending,
                        "sub_rank",
                        Ascending,
                        "rank",
                        Ascending,
                        "DocumentDate",
                        Descending
                    ),
                    JSONFormat.IndentFour
                )
            );
            Notify(
                msg_loading,
                NotificationType.Information,
                80000
            );
            Set(
                Var_Excel_URL,
                SCSExportExcelMethod.Run(OutPutTxt).linkoutput
            );
            If(
                IsBlankOrError(Var_Excel_URL),
                Notify(msg_exportError),
                Download(Var_Excel_URL);
                
            );
        Text: ="Export"
        Width: =108
        X: =298
        Y: =678
        ZIndex: =10

    Label4_5 As label:
        FontWeight: =FontWeight.Bold
        Height: =52
        Size: =23
        Text: ="Part A Company"
        Underline: =true
        Width: =296
        X: =245
        Y: =111
        ZIndex: =11

    ComboBox1 As combobox:
        DisplayFields: =["Result"]
        IsSearchable: =false
        Items: |-
            = Distinct(
                    ContractManagementList.Vendor,
                    Vendor.Value
                )
        SearchFields: =["Result"]
        SearchItems: =[]
        SelectMultiple: =false
        Width: =318
        X: =1007
        Y: =117
        ZIndex: =12

    ComboBox1_1 As combobox:
        DefaultSelectedItems: =
        DisplayFields: =["Result"]
        Items: =Distinct(ContractManagementList.簽約主體, 簽約主體)
        SearchFields: =["Result"]
        SearchItems: =Search(Distinct(ContractManagementList.簽約主體, 簽約主體),ComboBox1_1.SearchText,"Result")
        SelectMultiple: =false
        Width: =318
        X: =524
        Y: =117
        ZIndex: =13

    HI_refresh_2 As icon.Reload:
        Color: =RGBA(255, 255, 255, 1)
        Height: =52
        Icon: =Icon.Reload
        OnSelect: |
            =Refresh(ContractManagementList);
            
            ClearCollect(
                ReportCollect,
                ContractManagementList
            );
            
            ClearCollect(
                addCol_C_R,
                AddColumns(
                    ReportCollect As Filter_DS,
                    "Vendor_text",
                    Filter_DS.Vendor.Value,
                    "Title_contratType",
                    Filter_DS.'是主約、附約或追加金額？'.Value,
                    "contract_Group",
                    Filter_DS.簽約主體,
                    "Currency_text",
                    Filter_DS.Currency.Value,
                    "Part_A_Signer",
                    Filter_DS.我方簽約,
                    "Part_B_Signer",
                    Filter_DS.對方簽約人,
                    "sign-in Date",
                    Filter_DS.'Sign-inDate',
                    "Reason_T",
                    Filter_DS.追加原因,
                    "Contract_type",
                    Filter_DS.ContractType.Value,
                    "Belong_Main",
                    If(
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_mainContract,
                        Text(Filter_DS.ID),
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_subContract || (Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.附約)),
                        Text(Filter_DS.主約),
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.主約),
                        ""
                    ),
                    "sub_rank",
                    If(
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_mainContract || (Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.附約)),
                        -1,
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_subContract,
                        Text(Filter_DS.ID),
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.主約),
                        Filter_DS.附約
                    ),
                    "rank",
                    If(
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_mainContract,
                        1,
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_subContract,
                        3,
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.附約),
                        2,
                        4
                    ),
                    "Group",
                    If(
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_mainContract,
                        Filter_DS.ProjectName,
                        ""
                    ),
                    "SubGroup",
                    If(
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(Filter_DS.主約),
                            First( 
                                Filter(ReportCollect As fiter_DS,
                                        fiter_DS.ID = Value(Filter_DS.附約)
                                    )
                            ).ProjectName,
                        Filter_DS.'是主約、附約或追加金額？'.Value = const_subContract,
                            Filter_DS.ProjectName,
                            Blank()
                    )
                )
            );
            ClearCollect(
                updateCol_C_R,
                UpdateIf(
                    addCol_C_R As updateIf_DS,
                    updateIf_DS.'是主約、附約或追加金額？'.Value = const_suppleB && IsBlank(updateIf_DS.主約),
                    {
                        Belong_Main: First(
                            Filter(
                                addCol_C_R As fiter_DS,
                                fiter_DS.ID = Value(updateIf_DS.附約)
                            )
                        ).Belong_Main
                    }
                )
            );
            
            ClearCollect(
                fin_C_R,
                UpdateIf(
                    updateCol_C_R As updateIf_DS,
                    updateIf_DS.'是主約、附約或追加金額？'.Value <> const_mainContract,
                    {
                        Group: First(
                                    Filter(
                                        updateCol_C_R As fiter_DS,
                                        fiter_DS.ID = Value(updateIf_DS.Belong_Main)
                                    )
                            ).ProjectName
                    }
                )
            );
        Width: =44
        X: =1296
        Y: =14
        ZIndex: =14

    Gallery1 As gallery.galleryHorizontal:
        Height: =101
        Items: |-
            =SortByColumns(
                AddColumns(
                    GroupBy(
                        AddColumns(
                            Filter(
                                fin_C_R As DS,
                                If(
                                    CountRows(ComboBox1.SelectedItems) > 0,
                                    DS.Vendor.Value in ComboBox1.SelectedItems.Result,
                                    1 = 1
                                ),
                                If(
                                    CountRows(ComboBox1_1.SelectedItems) > 0,
                                    DS.contract_Group in ComboBox1_1.SelectedItems.Result,
                                    1 = 1
                                ),
                                Text(DS.deletionFlag) = Text(false)
                            ) As TTDS,
                            "Currency_str",
                            TTDS.Currency.Value
                        ),
                        "Currency_str",
                        "CurrencyGroup"
                    ) As GPDS,
                    "SumOfCurrency",
                    Sum(
                        GPDS.CurrencyGroup,
                        Amount
                    )
                ),
                "Currency_str",
                Descending
            )
        TemplateSize: =347
        Width: =743
        X: =605
        Y: =648
        ZIndex: =15

        Label12 As label:
            FontWeight: =FontWeight.Bold
            Height: =91
            OnSelect: =Select(Parent)
            Size: =30
            Text: |-
                =Text(Value(ThisItem.SumOfCurrency, "en-US"), ThisItem.Currency_str &" #,###", "en-US")
            Underline: =true
            Width: =347
            ZIndex: =1

